{% extends "base.html" %}
{% load crispy_forms_tags %}
{% load coffeescript %}
{% block head %}
<script src="{% static "scripts/clone-form.js"%}" type="text/javascript"></script>

{% endblock %}
{% block content %}
<div class="row">
	<div class="span9">
		<h2>Edit images</h2>
		<div class="lead">Select an image from the list at left and edit its properties in the form at right.</div>
	</div>
	<div class="span2">
		<button class="btn btn-large btn-primary" id="submit-form" style="margin: 35px 0px 0px 20px; font-size: 24px; padding: 10px 20px; line-height: 1.4em">Save</button>
	</div>
	<div class="span11"><hr/></div>
	<div class="span3 well well-lite">
		<ul>
			<li class="nav-header">Images in collection:</li>
		</ul>
		<div id="collection_hldr">
			<ul class="nav nav-tabs nav-stacked collection_nav" id="image-select">
				{% for form in formset %}
				{% if form.nidm_results %}
				<li id="showform-image-{{forloop.counter0}}"{% if forloop.first %} class="active"{% endif %}><a href="#"><i class="icon-archive"></i>&nbsp;{{form.instance.nidm_results}}&nbsp;<i class="icon-double-angle-right"></i>&nbsp;{{form.name.value}}</a></li>
				{% else %}
				<li id="showform-image-{{forloop.counter0}}"{% if forloop.first %} class="active"{% endif %}><a href="#"><i class="icon-file-alt"></i>&nbsp;{{form.name.value}}</a></li>
				{% endif %}
				{% endfor %}
			</ul>
		</div>
		<button class="btn btn-large btn-secondary" id="add-image-form" style="margin: 0px 0px 0px 20px;">Add a new image</button>
	</div>
	<div class="span8">
		<ul class="breadcrumb">
			<li>
				<div id="current-image">{{ formset.0.name.value }}</div>
			</li>
		</ul>
		<form class="form-horizontal" enctype="multipart/form-data" method="post" action="">{% csrf_token %}
			{{ formset.management_form }}
			{% for form in formset %}
			<div id='image-{{forloop.counter0}}' class='image-form'>
				<input id="id_image_set-{{forloop.counter0}}-image_ptr" name="image_set-{{forloop.counter0}}-image_ptr" type="hidden" value="{{form.instance.image_ptr_id}}" />
				{{form | crispy }}
			</div>
			{% endfor %}
		</form>
		<div id='blank_atlas' class='hide'>
			{{blank_atlas | crispy }}
		</div>
		<div id='blank_statmap' class='hide'>
			{{blank_atlas | crispy }}
		</div>
	</div>
</div>

{% endblock %}
